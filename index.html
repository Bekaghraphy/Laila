<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Laila Ai</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="favicon.png">

    <link rel="stylesheet" href="style.css" />
</head>

<body>

    <!-- Animated Gradient Background -->
    <div class="animated-bg"></div>

    <!-- Language Switch -->
    <div class="lang-toggle">
        <div id="langSwitch" class="toggle-btn">
            <div class="toggle-circle"></div>
        </div>
    </div>

    <!-- LOGO -->
    <div class="logo-box">
        <div class="logo-circle">
            <span class="logo-letter">L</span>
        </div>
        <p class="logo-sub">Creative Intelligence Engine</p>
    </div>

    <!-- MAIN CONTENT -->
    <div class="container">

        <h1 class="title">LAILA AI</h1>

        <!-- Upload -->
        <div class="upload-box">
            <label for="fileInput" class="upload-label">Upload Photo</label>
            <input type="file" id="fileInput" accept="image/*">
        </div>

        <!-- Preview -->
        <div id="previewHolder" class="preview-holder"></div>

        <!-- Action Buttons -->
        <div class="actions">
            <button id="btnPrompt" class="btn primary">Generate Prompt</button>
            <button id="btnGenerate" class="btn secondary">Generate Image</button>
        </div>

        <!-- Prompt Output -->
        <textarea id="promptOutput" class="prompt-output" placeholder="Generated prompt will appear here..."></textarea>

    </div>

    <footer>
        © 2025 LAILA.ONE — Private creative intelligence for visual storytellers.
    </footer>

    <!-- ===================== PREVIEW SCRIPT ===================== -->
    <script>
        const fileInput = document.getElementById("fileInput");
        const preview = document.getElementById("previewHolder");

        fileInput.addEventListener("change", function () {
            preview.innerHTML = "";
            const file = this.files[0];
            if (!file) return;

            const img = document.createElement("img");
            img.src = URL.createObjectURL(file);
            img.className = "preview-img";

            preview.appendChild(img);
        });
    </script>

    <!-- ===================== BACKEND CONNECTION ===================== -->
    <script>
        async function uploadImageAndGetDescription(file) {
            const formData = new FormData();
            formData.append("image", file);

            const backendURL =
                "https://d10e6243-c58b-49f1-be59-b43234a564af-00-18g0n3rc9lyb.sisko.replit.dev/generate-description";

            try {
                const response = await fetch(backendURL, {
                    method: "POST",
                    body: formData
                });

                const data = await response.json();
                return data.description || "Error: No description returned.";

            } catch (err) {
                console.error(err);
                return "Failed to reach Laila AI backend.";
            }
        }

        // === Generate Prompt Button ===
        document.getElementById("btnPrompt").addEventListener("click", async () => {
            const fileInput = document.getElementById("fileInput");
            const output = document.getElementById("promptOutput");

            if (!fileInput.files.length) {
                output.value = "Please upload an image first.";
                return;
            }

            output.value = "Generating prompt… please wait.";

            const file = fileInput.files[0];
            const description = await uploadImageAndGetDescription(file);

            output.value = description;
        });
    </script>

</body>
</html>
